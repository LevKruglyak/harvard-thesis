\usepackage{xcolor}
\usepackage{xstring}
\usepackage{graphicx}

% For debugging
\usepackage{lipsum}

% Epigraphs
\usepackage{cjhebrew}

% Index
\usepackage{imakeidx}
\makeindex[intoc]

% -----------------------------------------------
%              Basic math stuff
% -----------------------------------------------

\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{mathtools}
\usepackage{amsthm}
\usepackage{amssymb} % Standard ams libraries
\usepackage{bm} % Bold math
\usepackage{mathrsfs}
\usepackage{cancel}

% -----------------------------------------------
%              Page Style 
% -----------------------------------------------
\usepackage[twoside]{fancyhdr}
\def\afterpreface{\newpage
	\pagestyle{fancy}}
\pagestyle{fancy}
% \fancyhead[C]{\rule{.5\textwidth}{4\baselineskip}}
\setlength{\headheight}{0.5in}
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\fancyhf[leh,roh]{\thepage}
\fancyhf[loh,reh]{\slshape\leftmark}

% -----------------------------------------------
%              References
% -----------------------------------------------
\ifthenelse{\boolean{development}}
{
}
{
	\usepackage[style=alphabetic, natbib=true]{biblatex}
	\bibliography{refs}{}
}

\usepackage{hyperref}
\usepackage[capitalize,nameinlink,noabbrev]{cleveref}

\hypersetup{
	colorlinks=true,
	linkcolor=blue,
	citecolor=green!50!black,
	filecolor=gray,
	urlcolor=red!50!black
}

\renewcommand{\chapterautorefname}{Chapter}
\renewcommand{\sectionautorefname}{Section}
\renewcommand{\subsectionautorefname}{Section}

% -----------------------------------------------
%              Environments
% -----------------------------------------------

\newenvironment{changemargins}{%
\begin{list}{}{%
		\setlength{\itemsep}{0em}
		\setlength{\topsep}{0em}%
		\setlength{\leftmargin}{1em}%
		\setlength{\rightmargin}{1em}%
		\setlength{\listparindent}{\parindent}%
		\setlength{\itemindent}{\parindent}%
		\setlength{\parsep}{\parskip}%
	}%
	\item\leavevmode\vspace{-1.5em}
	      }{
\end{list}
{\medskip}
}

\newcommand\keyword[1]{{\emph{#1}}\index{#1}}
\newcommand\defn[1]{\textbf{\emph{#1}}\index{#1}}
\newcommand\todo[1]{{\color{red}\textbf{#1}}}

\newtheoremstyle{lkx_theorem}
{}{}{\slshape}{}{}{.}{ }
{{\bfseries\thmname{#1}\thmnumber{ #2}}\thmnote{ (#3\index{#3})}}

\theoremstyle{lkx_theorem}
\newtheorem{theorem}{Theorem}[chapter]
\renewcommand{\theoremautorefname}{Theorem}

\newtheorem{claim}[theorem]{Claim}
\newcommand{\claimautorefname}{Claim}

\newtheorem{lemma}[theorem]{Lemma}
\newcommand{\lemmaautorefname}{Lemma}

\newtheorem{corollary}[theorem]{Corollary}
\newcommand{\corollaryautorefname}{Corollary}

\newtheorem{proposition}[theorem]{Proposition}
\newcommand{\propositionautorefname}{Proposition}

\newtheoremstyle{lkx_definition}
{}{}{\slshape}{}{}{.}{ }
{{\bfseries\thmname{#1}\thmnumber{ #2}}\thmnote{ (#3\index{#3})}}

\theoremstyle{lkx_definition}
\newtheorem{definition}[theorem]{Definition}
\newcommand{\definitionautorefname}{Definition}

\newtheorem{remark}[theorem]{Remark}
\newcommand{\remarkautorename}{Remark}

\newtheorem{example}[theorem]{Example}
\newcommand{\exampleautorename}{Example}

\newtheorem*{definition*}{Definition}
\newtheorem*{theorem*}{Theorem}
\newtheorem*{remark*}{Remark}
\newtheorem*{proposition*}{Proposition}
\newtheorem*{claim*}{Claim}
\newtheorem*{lemma*}{Lemma}
\newtheorem*{example*}{Example}
\newtheorem*{corollary*}{Corollary}

% -----------------------------------------------
%              Common Math
% -----------------------------------------------

% Common number systems
\providecommand{\Z}{\mathbb{Z}}
\providecommand{\Q}{\mathbb{Q}}
\providecommand{\R}{\mathbb{R}}
\providecommand{\N}{\mathbb{N}}
\providecommand{\C}{\mathbb{C}}
\providecommand{\HH}{\mathbb{H}}
\providecommand{\F}{\mathbb{F}}

% Projective spaces
\providecommand{\CP}{\mathbb{CP}}
\providecommand{\RP}{\mathbb{RP}}

% Algebraic structures and operators
\providecommand{\lcm}{\operatorname{lcm}}
\providecommand{\gcd}{\operatorname{gcd}}
\providecommand{\End}{\operatorname{End}}
\providecommand{\Hom}{\operatorname{Hom}}
\providecommand{\Ann}{\operatorname{Ann}}
\providecommand{\Aut}{\operatorname{Aut}}
\providecommand{\Tor}{\operatorname{Tor}}
\providecommand{\Ext}{\operatorname{Ext}}
\providecommand{\Spec}{\operatorname{Spec}}
\providecommand{\Proj}{\operatorname{Proj}}
\renewcommand{\H}{\operatorname{H}}

% Manifolds
\providecommand{\Gr}{\operatorname{Gr}}

% Lie groups and algebras
\providecommand{\GL}{\operatorname{GL}}
\providecommand{\SL}{\operatorname{SL}}
\providecommand{\SO}{\operatorname{SO}}
\providecommand{\O}{\operatorname{O}}
\providecommand{\SU}{\operatorname{SU}}
\providecommand{\U}{\operatorname{U}}
\providecommand{\Sp}{\operatorname{Sp}}
\providecommand{\g}{\mathfrak{g}}
\providecommand{\gl}{\mathfrak{gl}}
\providecommand{\sl}{\mathfrak{sl}}
\providecommand{\h}{\mathfrak{h}}
\providecommand{\n}{\mathfrak{n}}
\providecommand{\Lie}{\operatorname{Lie}}

% Category Theory
\providecommand{\cat}{\mathbf}
\providecommand{\Set}{\cat{Set}}
\providecommand{\Top}{\cat{Top}}
\providecommand{\Vect}{\cat{Vect}}
\providecommand{\hTop}{\cat{hTop}}

% Misc
\providecommand{\op}{\operatorname}
\providecommand{\geq}{\geqslant}
\providecommand{\leq}{\leqslant}
