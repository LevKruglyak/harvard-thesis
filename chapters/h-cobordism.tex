\chapter{The \texorpdfstring{$h$}{h}-Cobordism Theorem}\label{chap:h-cobordism}

\todo{prove h-cobordism, define groups of homotopy spheres}

\section{Morse Theory}\label{sec:morse-theory}

The last tool in our arsenal is that of Morse theory, introduced in \cref{sec:morse-theory}.

\todo{Morse theory is a technique connecting the structure of a manifold to the behavior of a (nice) smooth function from the manifold to the real numbers. By investigating the discrete set of critical points of such a function, questions of attaching and removing high-dimensional handles is simplified to questions of points on the one-dimensional real line. For this thesis, the main application of Morse theory will be in the proof of the $h$-cobordism theorem of \cref{chap:h-cobordism}, however we make occasional use of Morse theory in historical remarks and for explicit constructions of exotic spheres scattered throughout.}

While a fully comprehensive introduction to Morse theory is outside of the scope of this thesis, we'll include a basic overview for completeness. A great classical introduction to Morse theory can be found in Milnor's book on the subject \cite{milnor1963morse}.

If $f : M \to \R$ is a smooth function on a manifold $M$, the points $p\in M$ where the differential $df_p : \T_p M \to \T_{f(p)} \R = \R$ vanish are known as \defn{critical points}, and their images in $\R$ are called \defn{critical values}. In terms of local coordinates $\{x^1,\ldots, x^n\}$ at $p$, this means that
\begin{equation}
	\frac{\partial f}{\partial x^1}=\cdots=\frac{\partial f}{\partial x^n} = 0.
\end{equation}
A critical point $p\in M$ is said to be \defn{non-degenerate}[non-degenerate point] if the matrix
\begin{equation}
	\everymath={\displaystyle}
	\renewcommand*{\arraystretch}{2}
	H_f(p) = \begin{pmatrix}
		\frac{\partial^2 f}{\partial x^1\partial x^1} & \cdots &
		\frac{\partial^2 f}{\partial x^1\partial x^n}                   \\
		\vdots                                        & \ddots & \vdots \\
		\frac{\partial^2 f}{\partial x^n\partial x^1} & \cdots &
		\frac{\partial^2 f}{\partial x^n\partial x^n}                   \\
	\end{pmatrix}(p)
\end{equation}
is invertible at $p$. This is called the \defn{Hessian matrix} of $f$ at $p$, and in this formulation depends on our chosen coordinate system.
There is a coordinate independent way to define the Hessian as a symmetric bilinear form on $\T_p M$ which makes the coordinate invariance of the condition of non-degeneracy manifestly apparent.

\begin{definition}
	The \defn{index}[index of a function] of $f$ at a point $p$ is the maximal dimension of a subspace on which $H_f(p)$ is negative definite, i.e. it is the dimension of $\{v\in \R^n \mid v^\intercal H_f(p) v < 0\}.$
\end{definition}

The index of a function at a point essentially describes the ``shape'' of the function out of a list of finitely many possible shapes. Remember, the index of a function on an $n$-dimensional manifold must be an integer between $0$ and $n$. For instance, in the case of a surface there are three possible shapes -- when both coordinates curve up we get a bowl facing up, when one curves up and one curves down we get a saddle, and when both coordinates curve down we get a bowl facing down. These shapes correspond to indices of $0$, $1$, and $2$ respectively.
\begin{figure}[ht]
	\centering
	\import{diagrams}{placeholder.pdf_tex}
	\caption{An upward bowl, saddle, and downward bowl.}
\end{figure}

The fundamental lemma of Morse theory makes rigorous this notion of a manifold having a shape dictated by a real-valued function -- there is always a local coordinate system which puts the function into a standard form depending on the index.

\begin{lemma}[Morse Lemma]\label{lemma:morse}
	Let $p$ be a non-degenerate critical point of $f$. There is a local coordinate system $(y^1,\ldots, y^n)$ at $p$ such that
	\begin{equation}
		f(y^1,\ldots, y^n)=f(0)-\left[(y^1)^2 + \cdots + (y^{\ell})^2\right] + \left[(y^{\ell + 1})^2 + \cdots + (y^n)^2\right].
	\end{equation}
	where $\ell$ is the index of $f$ at $p$.
\end{lemma}
\begin{proof}
	Let's assume without loss of generality that $f(p)=0$. Given any local coordinate system $(x^1,\ldots, x^n)$ at $p$, we can write
	\begin{equation}
		f(x^1,\ldots, x^n) = \sum_{1\leq j \leq n} x^j g_j(x^1,\ldots, x^n)
	\end{equation}
	where $g_j$ are functions satisfying $g_j(0)=(\partial f / \partial x^j)(0)$.
	This can be achieved by setting $g_j(x_1,\ldots, x_n) = \int_0^1 (\partial f/\partial x^j)(tx_1, \ldots, tx_n)\,dt$. Since $p$ is a critical point

	\todo{basic idea}
\end{proof}

Inspired by this lemma, we might call a function $f : M \to \R$ a \defn{Morse function} if all critical points are non-degenerate.

\begin{corollary}
	Non-degenerate critical points are isolated.
\end{corollary}

For a brief demonstration of the power of the Morse lemma, we'll prove Reeb's theorem, a Morse theoretic criterion for a compact manifold to be homeomorphic to a sphere. Throughout the thesis, we'll usually defer to the more powerful $h$-cobordism theorem to prove that a manifold is homoemorphic to a sphere.
However, it is useful to not always rush for the flamethrower when trying to kill a fly -- a simple swatter might do the trick. We'll see a direct application of this lighter theorem in \cref{sec:milnor-spheres}.

\begin{theorem}[Reeb]\label{thm:reeb}
	If $M$ is a compact manifold and $f$ is a Morse function with exactly $2$ critical points, then $M$ is homeomorphic to a sphere.
\end{theorem}
\begin{proof}
	Firstly, by compactness of $M$ we can find a global minimum $f(x_0)$ and global maximum $f(x_1)$ for some distinct points $x_0$ and $x_1$ (otherwise the function would be constant and not a Morse function with $2$ critical points). We can normalize the function $f$ to have $f(x_0)=0$ and $f(x_1)=1$ without loss of generality. It follows that $x_0$ is a non-degenerate critical point of index 0 and $x_1$ is a non-degenerate critical point of index $n$.
	By the Morse lemma (\ref{lemma:morse}), there is a neighborhood $x_0\in U_0$ with local coordinates $\{y^1,\ldots, y^n\}$ such that
	\begin{equation}
		f(y^1,\ldots, y^n) = (y^1)^2 + \cdots + (y^n)^2.
	\end{equation}
	This gives a Riemannian metric $(dy^1)^2+\cdots+(dy^n)^2$ on $U$ which can be extended to all of $M$ by partitions of unity.
	% A Riemannian metric on a manifold $M$ determines an isomorphism $\T^\d M \cong \T M$, and hence an isomorphism $\Omega^1(M)=\Gamma(\T^\d M) \cong \Gamma(\T M)=\X(M)$ between the space of $1$-forms and the space of vector fields. Composing this isomorphism with the exterior derivative $d : \Omega^0(M)\to \Omega^1(M)$ gives the gradient operator $\nabla : \Omega^0(M) \to \X(M)$ sending a function to its vector field. 

	Given a Riemmanian structure, there is a gradient operator $\nabla : \Omega^0 \to \X(M)$ sending functions to vector fields.
	In our case, the vector field $\nabla f$ is non-zero everywhere except for at $x_0$ and $x_1$. We thus have a normalized vector field $\nabla f/\|\nabla f\|^2$
	defined everywhere except for at $x_0$ and $x_1$. Let $\varphi_t : M \to M$ be the global flow corresponding to this vector field, i.e. the unique solution to the differential equation
	\begin{equation}
		\left.\frac{d\varphi_t(p)}{dt}\right|_{t=0} = \frac{\nabla f(p)}{\|\nabla f(p)\|^2}
	\end{equation}
	for all $p\in M\setminus \{x_0,x_1\}$. By the chain rule, it follows that
	\begin{equation}
		\frac{d(f\circ \varphi_t(p))}{dt}=\left\langle \frac{d\varphi_t(p)}{dt}, \nabla f\right\rangle = \left\langle \frac{\nabla f}{\|\nabla f\|^2}, \nabla f\right\rangle=1.
	\end{equation}
	In particular, this implies that $f\circ \varphi_t(p) = f(p)+t$.

	\todo{finish the proof}
\end{proof}

The basic ideas used in the proof of Reeb's theorem can be radically generalized.

\begin{definition}
	For any $a\in \R$, the \defn{level set} of a smooth function $f : M \to \R$ is the set
	\begin{equation}
		M_a = f^{-1}(-\infty, a] = \{ p\in M \mid f(p)\leq a)\}.
	\end{equation}
\end{definition}

\begin{figure}
\end{figure}

\begin{theorem}
	Let $f : M \to \R$ be a smooth function and suppose $f^{-1}[a,b]$ contains no critical points of $f$ for real numbers $a<b$. Then $M_a$ is diffeomorphic to $M_b$. Furthermore $M_a$ is a deformation retract of $M_b$.
\end{theorem}

\begin{theorem}
	Let $f : M \to \R$ be a smooth function and let $p$ be a non-degenerate critical point of index $\ell$. Letting $c=f(p)$, suppose that $f^{-1}[c-\epsilon, c+\epsilon]$ is compact and contains no critical points of $f$ aside from $p$. For sufficiently small $\epsilon$, the level set $M^{c+\epsilon}$ has the homotopy type of $M^{c-\epsilon}$ with an $\ell$-cell attached.
\end{theorem}

\begin{theorem}
	If $f$ is a Morse function with compact level sets (for instance if $M$ is compact), then $M$ has the homotopy type of a CW-complex with a cell in each dimension $\ell$ for each critical point of index $\ell$.
\end{theorem}

\todo{finish}

\begin{theorem}[Morse Inequality]
	Let $M^n$ be a closed manifold with $f : M\to \R$ a Morse function. Let $\beta_i=\rank \H_i(M)$ be the $i$-th Betti number of $M$ and let $c_i$ be the number of critical points of $f$ of index $i$. Then, for every $\ell\in \Z^{\geq 0}$ we have
	\begin{equation}
		\beta_\ell - \beta_{\ell-1} + \beta_{\ell-2} - \cdots +(-1)^\ell \beta_0 \leq c_\ell - c_{\ell-1} + c_{\ell-2} - \cdots + (-1)^\ell c_0.
	\end{equation}
\end{theorem}

\section{Handlebodies}

\begin{theorem}[$h$-cobordism]\label{thm:h-cobordism}
	Within some category of manifolds $\mathscr{C}$, if $M$ and $N$ are closed, simply-connected manifolds of dimensions $\geq 5$ and $W : M \hbord N$ is a simply-connected $h$-cobordism, then $W$ is $\mathscr{C}$-isomorphic to the cylinder $M\times [0,1]$. Furthermore, the isomorphism can be chosen to be the identity on $M\times \{0\}$.
\end{theorem}

\begin{example}
	The simple-connectedness assumption of the $h$-cobordism theorem is required, since the spaces $L(7,1)\times S^4$ and $L(7,2)\times S^4$ are $h$-cobordant but not diffeomorphic.
\end{example}

\begin{theorem}
	In the manifold categories $\TOP$ and $\PL$, the generalized Poincar\'e conjecture is true in dimensions $\geq 5$.
\end{theorem}
\begin{proof}
	\todo{cone construction, fails for $\DIFF$ because you can't take a smooth cone.}
	\todo{mention method of engulfing?}
\end{proof}

\begin{corollary}\label{thm:h-cobordism-diffeomorphism}
	In the smooth oriented manifold category, two simply-connected closed manifolds of dimensions $\geq 5$ are $h$-cobordant if and only if they are diffeomorphic (by an orientation preserving diffeomorphism).
\end{corollary}
\begin{proof}
	If $f : M_1 \to M_2$ is a diffeomorphism between manifolds $M_1$ and $M_2$, they are $h$-cobordant by the manifold $W=M_1\times [0,1]\cup_f M_2$, where we glue $M_2$ onto $M_1\times \{1\}$ in $M_1\times [0,1]$ by $f$.
	Conversely, if $W : M_1\sohbord M_2$ is an $h$-cobordism, by the $h$-cobordism theorem (\ref{thm:h-cobordism}) there must be a diffeomorphism $f : W \to M_2$ must map to $M_1\times \{1\}$, this gives a diffeomorphism $M_2 \to M_1$. If we choose $f$ to reverse orientation on $M_1\to M_1\times \{0\}$, then the restriction $f|_{M_2}$ will preserve orientation.
\end{proof}

\pagebreak
\section{Groups of Homotopy Spheres}\label{sec:groups-of-homotopy-spheres}

With the $h$-cobordism theorem and \cref{thm:h-cobordism-diffeomorphism}, we have arrived at our first major simplification to the problem of classifying smooth structures in dimensions $\geq 5$ -- to classify smooth structures on $S^n$, it is enough to classify the $h$-cobordism classes of smooth manifolds which are homeomorphic to $S^n$, and to find smooth manifolds which are homeomorphic to $S^n$,. it suffices to consider smooth manifolds which have the homotopy type of $S^n$.

\begin{definition}
	A \defn{homotopy $n$-sphere}[homotopy sphere] is a smooth manifold which is homotopy equivalent to the sphere $S^n$. By the generalized Poincar\'e conjecture, all homotopy spheres are homeomorphic to spheres.
\end{definition}

\begin{definition}
	Let $\Theta^n$ be the pointed set of $h$-cobordism classes of homotopy $n$-spheres (the basepoint is the ordinary sphere $S^n$).
\end{definition}

So far, this is a fairly general setup. Instead of spheres, we could use any simply-connected base manifold and consider the set of $h$-cobordism classes of manifolds homotopy equivalent to it. This is known as the \defn{surgery structure set}, and we will expand on this briefly in \cref{sec:surgery-theory-in-general}. However, in the case of spheres, there is a special bit of extra data which does not usually generalize -- a group structure under the connected sum operation defined in \cref{sec:connected-sum}.

\begin{theorem}\label{thm:group-of-homotopy-spheres}
	The connected sum turns $\Theta^n$ into a group with identity element $S^n$.
\end{theorem}
\begin{proof}
	We have already proved that the connected sum is well-defined up to diffeomorphism, associative, and commutative up to orientation preserving diffeomorphism.  
	The remaining proof splits as three lemmas -- these are Lemmas 2.2, 2.3, and 2.4 in \cite{milnorkervaire1963groups}.

	\begin{lemma}
		The connected sum is a well-defined operation on $\Theta^n$.
	\end{lemma}
	\begin{proof}
		We will prove something slightly more general. Let $M_1, M_1'$ and $M_2, M_2'$ be closed, simply-connected, and oriented manifolds, and suppose $W_1 : M_1\sohbord M_1'$ and $W_2 : M_2\sohbord M_2'$ are $h$-cobordisms. The goal is to construct an $h$-cobordism $W : (M_1\+M_2)\sohbord (M_1'\+M_2')$.

		\begin{figure}[ht]
			\centering
			\import{diagrams}{placeholder.pdf_tex}
			\caption{A join of two $h$-cobordisms along embedded arcs.}\label{fig:connected-sum-of-h-cobordisms}
		\end{figure}

		Recall that the connected sum $M_1\+M_2$ was defined as the join of $M_1$ and $M_2$ along points $p_1\in M_1$ and $p_2\in M_2$. Let us assume these were the points along which the connected sum $M_1\+M_2$ was taken, and $p_1'\in M_1'$ and $p_2'\in M_2'$ the points along which the connected sum $M_1'\+M_2'$ was taken. Choose smooth paths $\gamma_i : [0,1] \to W_i$ which send $p_i\mapsto p_i'$, and assume without loss of generality that $\gamma_i$ are embeddings which are transverse to the boundary of $\partial W_i$, making it possible to get tubular neighborhoods
		\[
			\lkxfunc{\iota_i}{\R^n\times [0,1]}{W_i.}
		\]
		Let $W$ be the join of $W_1$ and $W_2$ along the image of the arcs $\gamma_i$, as depicted in \cref{fig:connected-sum-of-h-cobordisms}. This is an oriented smooth manifold with boundary
		\[
			\partial W = (M_1\#M_2)\sqcup -(M_1'\+M_2')
		\]
		so $W$ is a cobordism $W : (M_1\+M_2)\sobord (M_1'\+M_2')$. We just need to prove that $W$ is an $h$-cobordism to complete the proof.

		\begin{lemma}\label{lemma:removing-point-homotopy-equivalence-h-cobordism}
			If $W : M \sohbord M'$ is an $h$-cobordism with $M,M'$ compact oriented and simply connected, $p\in M$ is a point, and $T$ is a tubular neighborhood of an arc from $p$ to $p'\in M'$, then the inclusion $M\setminus\{p\} \to W\setminus T$ is a homotopy equivalence.
		\end{lemma}
		\begin{proof}
			The long exact sequence of the inclusion $j : (M,M\setminus\{p\}) \to (W, W\setminus T)$ gives
			\[
				\H_{i+1}(W\setminus T, M\setminus\{p\})\lkxto
				\H_i(M\setminus\{p\}) \lkxto[j_*] \H_i(W\setminus T) \lkxto \H_i(W\setminus T, M\setminus\{p\})
			\]
			Note that by excision, $\H_i(W\setminus T, M\setminus\{p\})\cong \H_i(W,M)$, and since $W$ is an $h$-cobordism, $\H_i(W,M)\cong 0$. Consequently, $j$ induces isomorphisms on homology and since $M,M'$, and $W$ are simply connected, Whitehead's theorem and the Hurewicz isomorphism imply that $j$ is a homotopy equivalence.
		\end{proof}

		With \cref{lemma:removing-point-homotopy-equivalence-h-cobordism} in mind, we use the Mayer-Vietoris sequence
		\[\begin{tikzcd}
				{\H_i(S^{n-1})} & {\H_i(M_1\setminus\{p_1\})\oplus\H_i(M_2\setminus\{p_2\})} & {\H_{i}(M_1\+M_2)} & {\H_{i-1}(S^{n-1})} \\
				{\H_i(S^n)} & {\H_i(W_1\setminus T_1)\oplus\H_i(W_2\setminus T_2)} & {\H_{i}(W)} & {\H_{i-1}(S^n)}
				\arrow[from=1-1, to=1-2]
				\arrow[from=1-1, to=2-1]
				\arrow["f"', from=1-2, to=1-3]
				\arrow["{(j_1)_*\oplus (j_2)_*}", from=1-2, to=2-2]
				\arrow[from=1-3, to=1-4]
				\arrow["j_*", from=1-3, to=2-3]
				\arrow[from=1-4, to=2-4]
				\arrow[from=2-1, to=2-2]
				\arrow["g"', from=2-2, to=2-3]
				\arrow[from=2-3, to=2-4]
			\end{tikzcd}\]
			where $j_i : M_i\setminus \{p_i\} \to W_i\setminus T_i$ and $j : M_1\+ M_2\to W$ are inclusions. Note that $(j_1)_*\oplus (j_2)_*$ is an isomorphism by \cref{lemma:removing-point-homotopy-equivalence-h-cobordism}. When $i$ is not $1,n-1,$ or $n$, it follows immediately that $f$ and $g$ are isomorphisms and so $j$ is an isomorphism. In the remaining cases, a simple application of the  snake lemma does the trick.
			By simple connectedness, Whitehead's theorem, and the Hurewicz isomorphism, it follows that the inclusion of $M_1\+M_2 \to W$ is a homotopy equivalence, completing the proof.
	\end{proof}

	\begin{remark}
		In the previous lemma, the simple-connectedness assumption was not strictly required -- only used to reduce the problem of homotopy equivalence to a homology problem by Whitehead's theorem. It is possible to directly construct an explicit homotopy equivalence with a more careful argument.
	\end{remark}

	Next, we will prove a simple characterization of when a homotopy sphere is equal to the identity element in $\Theta^n$.

	\begin{lemma}\label{lemma:null-h-cobordant-iff-bounds-contractible}
		A simply-connected manifold $M$ is $h$-cobordant to $S^n$ if and only if $M$ bounds a contractible manifold.
	\end{lemma}
	\begin{proof}
		The forward direction is fairly straightforward. If $W : M\sohbord S^n$ is an $h$-cobordism, we can glue a tubular neighborhood of $D^{n+1}$ in $\R^{n+1}$ to $(-S^n)\subset \partial W$ along a collar neighborhood of $-S^n$ in $\partial W$. Any homotopy equivalence of $W$ to $S^n$ can then be extended to a contraction along $D^{n+1}$.

		In the reverse direction, let us assume that $M$ bounds a contractible manifold $W$. Pick any point in the interior of $M$ and remove the interior of an embedded disk $D^{n+1}\subset W$. This gives a simply-connected cobordism $W'=W\setminus \Int(D^{n+1}) : M\sobord (-S^n)$. By the long exact sequence of the inclusion $j : (D^{n+1}, S^n) \to (W,W')$, we have
		\[
			\H_i(W', S^n) \lkxto H_i(S^n)\lkxto[j_*] \H_i(W')\lkxto \H_{i-1}(W',S^n),
		\]
		and by contractability of $W$ the boundary terms vanish and so $S^n \to W'$ is a homotopy equivalence. Then, by the relative Poincar\'e duality isomorphism $\H_k(W',M)\cong \H^{n+1-k}(W', S^n)$ and the long exact sequence of the pair $(W',M)$, it follows that $M\to W'$ is a homotopy equivalence and so $W'$ is in fact an $h$-cobordism. 
	\end{proof}

	\begin{lemma}
		If $M$ is a homotopy sphere, then $M\+(-M)$ bounds a contractible manifold.
	\end{lemma}
	\begin{proof}
		\begin{figure}[ht]
			\centering
			\import{diagrams}{placeholder.pdf_tex}
			\caption{A contractible boundary of $M\+(-M)$.}
		\end{figure}
	\end{proof}


	\noindent This completes the proof.
\end{proof}

\subsection{Framed Manifolds}

\begin{definition}
\end{definition}
