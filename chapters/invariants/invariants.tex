\pagebreak
\section{Geometric Invariants}\label{sec:invariants-for-homotopy-4k-1-spheres}

Armed with the power of the signature theorem, we now attempt to build some invariants for homotopy spheres.
Due to the topological simplicity of homotopy spheres, it's difficult to imagine how we could construct such an invariant which can distinguish smooth structure. One of the great ideas of 20th century topology is to pass to a coboundary in situations like this. Namely, if the usual invariants on a manifold $M$ vanish, find a manifold $W$ a dimension higher which has $M$ as a boundary (this isn't always possible since not all manifolds are null-cobordant).
In the case such a manifold exists, it is referred to as a \defn{coboundary} of $M$. If we are careful, we can use the topology of the coboundary $W$ to construct an invariant which does not depend on the choice of coboundary $W$.

\begin{remark}
	This idea of passing to a coboundary is an example of constructing a \defn{secondary invariant}. When primary invariants, in this case characteristic forms, turn out to be zero, we lift to a case where they are not zero, and use the descent data to measure ``how'' the original invariants vanished. This is a central idea of Chern-Simons theory \cite{chernsimons1974geometric}, a topic which has found widespread application in constructing quantum field theories.
\end{remark}

\subsection{Invariants of Manifolds with Boundary}\label{sec:relative-invariants}

While there are no topological constraints needed to define invariants such as the signature or Euler characteristic on a manifold, constraints do appear when generalizing characteristic numbers to the manifolds with boundary. We will explore these subtleties in this section in preparation for the construction of exotic sphere invariants in \cref{sec:invariants-for-homotopy-4k-1-spheres}.

Suppose we have some cohomology and homology theory $h$ with coefficient ring $h_0(*)=R$.
Characteristic classes on an $n$-dimensional manifold $W$ are defined as cohomology classes in $c\in h^k(W)$. When the manifold is closed and the characteristic class is homogeneous of degree $n$, Poincar\'e duality allows us to associate a characteristic number $c[W]\in h_0(W)$ to $c$ given a fundamental class $[W]\in h_n(W)$. If $W$ has non-empty boundary, Poincar\'e-Lefschetz duality $h^k(W)\to h_{n-k}(W,\partial W)$ gives us an element $c[W]\in h_0(W,\partial W)$. However, this group is trivial for connected manifolds with non-empty boundary and so is a useless context in which to define relative characteristic numbers.

Instead, we try to pull back characteristic classes to the relative cohomology group $h^n(W,\partial W)$ so that Poincar\'e-Lefschetz duality gives us characteristic numbers in $h_0(W)\cong \Z$ for a fundamental class $[W,\partial W]\in \H_n(W,\partial W)$.
For any integer $\ell$, the pair $(W, \partial W)$ gives a long exact sequence of cohomology groups
\begin{equation}\label{eq:relative-characteristic-classes-exact-sequence}
	h^{\ell-1}(\partial W) \lkxto h^{\ell}(W, \partial W) \lkxto[j] h^{\ell}(W) \lkxto h^{\ell}(\partial W)
\end{equation}
where $j : h^{\ell}(W, \partial W) \to h^{\ell}(W)$ is the induced map of the inclusion $(W,\emptyset) \to (W, \partial W)$. This is an isomorphism if the groups on either side of \cref{eq:relative-characteristic-classes-exact-sequence} are trivial, which will allow us to pull back.

\begin{definition}\label{defn:relative-characteristic_form}
	Suppose that $h^{\ell}(\partial W)$ and $h^{\ell-1}(\partial W)$ are trivial. For a homogeneous characteristic class $c_\ell(W) \in h^{\ell}(W)$ of degree $\ell$, the \defn{relative characteristic form} is the pullback
	\[
		c_\ell(W, \partial W) = j^{-1} c_\ell(W) \quad\in h^{\ell}(W, \partial W).
	\]
	When the class is top-dimensional, i.e. when $\ell=n$, the \defn{relative characteristic number} is the Poincar\'e-Lefschetz dual number $c_\ell[W,\partial W] \in h_0(W)\approx R$.
\end{definition}

\begin{remark}
	There is an intuitive reason for why the topological invariance of characteristic numbers can break down if the manifold has boundary, and this perspective might be illuminating to physics-minded readers. We will work in de Rham cohomology. Characteristic classes are cohomology classes, and so any invariant built from them should be invariant under exact gauge transformations $c\mapsto c+d\Lambda$. For example, a change of Riemannian metric in Chern-Weil theory gives such a transformation with $\Lambda$ the relative Chern-Simons form. The corresponding variation in a characteristic number is then
	\[
		c[M] = \int_M c \quad\lkxto\quad \delta c[M] = \int_M c+d\Lambda-\int_M c = \int_{\partial M} \Lambda.
	\]
	The variation $\delta c[M]$ should vanish if $c[M]$ is to be a topological invariant. If the differential equation $\Lambda=dH$ has a solution on $\partial M$, the variation does vanishes and topological invariance is preserved. This is implied by the condition that $\HdR^{\ell-1}(\partial M)$ is trivial, but such a strong condition is not always needed. If there is some extra structure on $M$ restricting the choice of $\Lambda$ to be exact, it is possible to construct invariants even when $\HdR^{\ell-1}(\partial M)$ is non-trivial. See Section V of \cite{witten1985anomalies} for example of such a construction in the context of physics.
\end{remark}

\begin{definition}\label{defn:relative-characteristic-number-polynomial}
	Given a sequence of homogeneous polynomials $\{K_n\}$ (not necessarily multiplicative) and a characteristic class $c$, the relative characteristic number associated to $K$ is given by
	\[
		K_n(c_1, \ldots, c_n)[W,\partial W] = K_n(j^{-1}c_1(W), \ldots, j^{-1}c_n(W))[W,\partial W]
	\]
	whenever $h^{|c_i|-1}(\partial W)$ and $h^{|c_i|}(\partial W)$ are trivial for all $i$ such that $K_n$ contains an $x_i$ term.
\end{definition}

\begin{remark}
	Note that we pull back \emph{before} applying the polynomial $K$. This is because pulling back a top-dimensional form on $W$ is not generally possible since $h^{n-1}(W)$ is non-trivial and generated by the fundamental class.
\end{remark}

\begin{remark}
	Note that if $\partial W=\emptyset$, relative characteristic forms and numbers correspond exactly to the non-relative versions since $j$ becomes the identity map.
\end{remark}

Turning back to our goal of defining an invariant for a manifold $M$ by constructing an invariant of a coboundary $W$ of $M$, we next would like to understand how relative invariants such as the relative characteristic numbers change with respect to a change of coboundary.
There is a elegant trick we can use to help us answer this. If $W_1$ and $W_2$ are coboundaries for an $n$-dimensional manifold $M$, we can form a closed $(n+1)$-manifold $C$ by gluing $W_1$ and $W_2$ along their boundary $M$.

\begin{proposition}
	There is a unique smooth structure on $C$ which agrees with the smooth structures of $W_1$ and $W_2$. Furthermore, we can give $C$ an orientation which agrees with the orientation of $W_1$ and with the reverse orientation of $W_2$.
\end{proposition}
\begin{proof}
	This is simply a join operation (see \cref{sec:smooth-manifold-operations}) of $W_1$ and $W_2$ along collar neighborhoods (see \cref{thm:collar-neighborhood}) of the boundary $M$.
\end{proof}

For any $\ell$, the Mayer-Vietoris sequence gives an exact sequence
\[
	h^{\ell-1}(M)\lkxto h^{\ell}(C) \lkxto[\mu] h^{\ell}(W_1)\oplus h^{\ell}(W_2) \lkxto h^{\ell}(M)
\]
for any $\ell$, where $\mu$ is the ``restriction'' map. This is an isomorphism if $h^{\ell-1}(M)$ and $h^\ell(M)$ are trivial.
The relative version of the Mayer-Vietoris sequence is of the form
\[
	0 \lkxto h^{\ell}(C, M) \lkxto[\rho] h^{\ell}(W_1,M)\oplus h^{\ell}(B_2,M) \lkxto 0,
\]
since the boundary terms $\H^\ell(M,M)$ vanish, so we have an isomorphism $\rho$.
By the inclusion isomorphisms in \cref{eq:relative-characteristic-classes-exact-sequence}, and we have a commutative diagram
\begin{equation}\label{eq:closing_coboundaries_square}
	\begin{tikzcd}
		{h^{\ell}(C,M)} & {h^{\ell}(B_1,M)\oplus h^{\ell}(B_2,M)} \\
		{h^{\ell}(C)} & {h^{\ell}(B_1)\oplus h^{\ell}(B_2)}
		\arrow["j_1\oplus j_2"', from=1-2, to=2-2]
		\arrow["\rho"', from=1-1, to=1-2]
		\arrow["j"', from=1-1, to=2-1]
		\arrow["\mu"', from=2-1, to=2-2]
		\arrow["h", from=1-2, to=2-1, dashed]
	\end{tikzcd}
\end{equation}
In the case that $h^{\ell-1}(M)$ and $h^\ell(M)$ are trivial, every map in this diagram is an isomorphism. Otherwise, we can only assume that the top map $\rho$ is an isomorphism.
Of particular interest to us is the diagonal map $h = j\circ \rho^{-1}$, which ``glues'' together relative forms on $B_1$ and $B_2$ to a form on $C$. 

\begin{proposition}\label{prop:invariant-variation-naturality}
	This gluing map satisfies the following conditions:
	\begin{enumerate}[(a)]
		\item If $\alpha\in h^{n+1}(W_1, M)$ and $\beta\in h^{n+1}(W_2,M)$, then
		      $h(\alpha\oplus \beta)[C] = \alpha[W_1, M] - \beta[W_2, M]$.
		\item If $\alpha_i\in h^{\ell_i}(W_1,M)$ and $\beta_i \in h^{\ell_i}(W_2,M)$ for $i=1,2$, then
		      \[h(\alpha_1\oplus\beta_1) \smile h(\alpha_2\oplus \beta_2) = h(\alpha_1\smile \alpha_2 \oplus \beta_1\smile \beta_2).\]
	\end{enumerate}
\end{proposition}

\begin{corollary}\label{prop:relative-characteristic-number-variation}
	Given a polynomial $K$ satisfying the conditions of \cref{defn:relative-characteristic-number-polynomial},
	\[
		K_n(c_1,\ldots, c_n)[C] = K_n(c_1,\ldots, c_n)[W_1, M] - K_n(c_1,\ldots, c_n)[W_2, M].
	\]
\end{corollary}

We get a similar variation formula for the signature:

\begin{proposition}\label{prop:signature-variation}
	$\sigma(C)=\sigma(W_1)-\sigma(W_2)$.
\end{proposition}

We now have all of the tools needed to construct some basic invariants of homotopy spheres.

\subsection{Milnor's Method for Constructing Invariants}\label{sec:milnor-method}

Let us now use the theory developed in \cref{sec:relative-invariants} to construct an invariant for exotic spheres in 7-dimensions. For our cohomology theory, we use singular cohomology with rational coefficients and consider the Pontryagin numbers due to their connection with the signature.
Given a 7-dimensional homotopy sphere $M$ with 8-dimensional coboundary $W$, there are three invariants which we might consider -- the signature $\sigma$, and the Pontryagin classes $p_1^2$ and $p_2$.
Based on the cohomology of $M$, we have
\[
	\begin{aligned}
		\H^3(M; \Q)=0,  & \quad \H^4(M; \Q)=0 \\
		\H^7(M; \Q)=\Q, & \quad \H^8(M; \Q)=0 \\
		\H^3(M; \Q)=0,  & \quad \H^4(M; \Q)=0
	\end{aligned}
	\quad\implies\quad
	\begin{aligned}
		 & p_1^2\textrm{ does have a relative generalization.}        \\
		 & p_2\textrm{ does not have a relative generalization.}      \\
		 & \sigma\textrm{ satisfies \cref{prop:signature-variation}.}
	\end{aligned}
\]
Therefore, the two invariants of interest to us are
\[
	p_1^2[W,M]
	\quad\textrm{and}\quad
	\sigma(W).
\]
Now, for a \emph{closed} $8$-dimensional manifold $X$, rearranging the Hirzebruch signature theorem gives us the expression
\begin{equation}\label{eq:7-manifold_rearrangement}
	\sigma(X) = \frac{7p_2[X] - p_1^2[X]}{45}
	\quad\implies\quad
	p_2[X] = \frac{45\sigma(X) + p_1^2[X]}{7}.
\end{equation}
This suggests that there \emph{is} some analogue of the second Pontryagin number for $W$, even though the usual pull back strategy fails. For manifolds with boundary, we might consider the number
\[
	\widetilde{p_2}[W, M] = \frac{45\sigma(W) + p_1^2[W, M]}{7} \quad\in\Q.
\]
We use the notation $\widetilde{p_2}$ to emphasize that this is \emph{not} the relative Pontryagin number arising from a pullback of $p_2(W)$, but rather a formal expression which reduces to the Pontryagin number $p_2[W]$ when $W$ is closed by the Hirzebruch signature theorem.
How does the quantity change under a change in coboundary, say if $W_1$ and $W_2$ were coboundaries? Letting $C$ be the $8$-manifold obtained by gluing them together, we see that
\[
	\begin{aligned}
		\widetilde{p_2}[W_1,M] - \widetilde{p_2}[W_2,M]
		 & = \frac{45\sigma(W_1,M) + p_1^2[W_1,M]}{7} - \frac{45\sigma(W_2, M) + p_1^2[W_2,M]}{7} \\
		 & =\frac{45\sigma(C) + p_1^2[C]}{7} = p_2[C].
	\end{aligned}
\]
But this last term is just an ordinary Pontryagin number, and hence an integer. While $\widetilde{p_2}$ is a priori a rational number for a given coboundary, it changes by an integer -- namely by the Pontryagin number $p_2[C]$ of a closed manifold.
Taking the fractional part of $\widetilde{p_2}$ thus gives us an invariant of $M$ which is \emph{independent of the coboundary}!

\begin{remark}
	Given a homotopy sphere $M$, the quantity $\widetilde{p_2}[W,M]$ is a well-defined element of $\Q/\Z$ for any oriented coboundary $W$. It is common to multiply both sides by $7$ so that $7\cdot \widetilde{p_2}[W,M]$ is a well-defined element of $\Z/7$, although this is purely a convention and has no mathematical difference.
\end{remark}

\begin{definition}\label{def:milnor-invariant-7}
	Let $M$ be a null-cobordant\footnote{This is a redundant condition since all oriented $7$-manifolds are null-cobordant.}
	closed oriented $7$-manifold with $\H^3(M; \Q)$ and $\H^4(M; \Q)$ trivial. The \defn{Milnor invariant}\footnote{This differs from Milnor's original definition in \cite{milnor1956manifolds} by a factor of $2$ (mod 7) -- there he defined $\lambda=2p_1^2-\sigma \mod 7$.} of $M$ is
	\[
		\milinv(M) = 3\sigma(W)+p_1^2[W,M]\mod 7.
	\]
	for $W$ any oriented coboundary of $M$.
\end{definition}

Note that this expression is exactly $7\cdot \widetilde{p_2}[W,M]\mod 7$.

\begin{remark}
	Since it takes values in $\Z/7$, the ``resolution'' of the Milnor invariant is at most $7$, meaning that it can detect at most $7$ distinct smooth structures on a $7$-dimensional sphere. We will see a refinement of this invariant in \cref{sec:eells-kupier-invariant} which is able to detect all $28$ smooth structures.
\end{remark}

The basic ideas outlined for $7$-manifolds should work for $(4k-1)$-manifolds in general, so let us work through this case. If we require that $\H^{2i}(M)$ and $\H^{4i}(M)$ are trivial for all $i<k$, then Poincar\'e duality ensures that $\H^{2i-1}(M)$ and $\H^{4i}(M)$ are trivial as well. For full generality, we should also assume that $M$ is null-cobordant (which all homotopy-spheres are) so that a coboundary exists, although results in \cref{sec:cobordism} imply that all $(4k-1)$-manifolds are oriented null-cobordant.

As in the $7$-dimensional case, all but the top-dimensional Pontryagin classes can be generalized to a coboundary $W$.
If we let $X$ be a closed $4k$-manifold and use the Hirzebruch signature theorem, we can do a rearrangement similar to \cref{eq:7-manifold_rearrangement} in order to get the expression
\begin{equation}\label{eq:4k-1-manifold_rearrangement}
	\sigma(X) = L_k(p_1, \ldots, p_k)[X]\quad\implies\quad
	p_k[X] = \frac{\sigma(X) - L_k(p_1,\ldots, p_{k-1}, 0)[X]}{s_k}.
\end{equation}
Here $s_k=L_k(0,\ldots, 0, 1)$ is the coefficient of $x_k$ in the $L$-genus $L(x_1,\ldots, x_k)$.
As before, we use the rearrangement \cref{eq:4k-1-manifold_rearrangement} to get a rational number
\[
	\widetilde{p_k}[W, M] = \frac{\sigma(W) - L_k(p_1,\ldots, p_{k-1}, 0)[W,M]}{s_k}
\]
which acts as a rational generalization of the $k$-th Pontryagin class. By \cref{prop:relative-characteristic-number-variation} and \cref{prop:signature-variation}, given any coboundaries $W_1$ and $W_2$ we get
\[
	\widetilde{p_k}[W_1, M] - \widetilde{p_k}[W_2, M] = p_k[C],
\]
where $C$ is the gluing of $B_1$ and $B_2$. Since the $k$-th Pontryagin number of a closed manifold is an integer, we take the fractional part of $\widetilde{p_k}[W,M]$ and multiplying by the common denominator, we arrive at an generalization of the Milnor invariant for a $7$-manifold.

\begin{definition}
	Let $M$ be a null-cobordant closed $(4k-1)$-manifold with $\H^{4i}(M)$ and $\H^{2i}(M)$ trivial for all $i<n$. The \defn{Milnor invariant} of $M$ is
	\[
		\milinv(M) = \denom(s_k)\cdot \left(\sigma(W) - L_k(p_1, \ldots, p_{k-1},0)[W,M]\right)\mod \numer(s_k),
	\]
	where $s_k = L_k(0,\ldots,0,1)$ is the coefficient of the last term in the $L$-polynomial and $\numer$ and $\denom$ take the numerator and denominator of a rational number respectively.
\end{definition}

\begin{example}
	The first few Milnor invariants are:
	\[
		\renewcommand{\arraystretch}{1.2}
		\begin{array}{r@{\;}ll}
			\milinv(M^7)
			 & = 4\sigma(W) - p_1^2[W, M]
			 & \mod 7,                                                        \\
			\milinv(M^{11})
			 & = 15\sigma(W) - (2p_1^3-13p_1p_2)[W,M]
			 & \mod 62,                                                       \\
			\milinv(M^{15})
			 & = 303\sigma(W) - (3p_1^4-22p_1^2p_2 + 19p_2^2 + 71p_1p_3)[W,M]
			 & \mod 381.
		\end{array}
	\]
\end{example}

To generalize the Milnor invariants, it is helpful to take a bird's eye view of what happened here. We started with the idea that lifting to a coboundary could shed geometric insights to the boundary. Once on this coboundary, we pick a characateristic number which takes on a restricted set of values for closed manifolds representing a ``change of coboundary''. Moding out by the image of such changes, we get an invariant purely of the boundary. To summarize, we have a loose procedure
\[
	\left\{\parbox{12.5em}{An integrality theorem for a characteristic number of a closed $(n+1)$-manifold}\right\}
	\quad\lkxto\quad
	\left\{\parbox{9.5em}{A smooth invariant for certain $n$-dimensional manifolds}\right\}
\]
In the case of the Milnor invariant, the integrality of the top-dimensional Pontryagin number of a closed $4k$-manifold led us to Milnor's invariant for $(4k-1)$-manifolds with certain vanishing cohomology groups.
If we use a different integrality theorem, this procedure gives a different invariant.

\subsection{The Eells-Kupier Invariant}\label{sec:eells-kupier-invariant}

In the previous section, we used the Hirzebruch signature theorem to construct the Milnor invariant for manifolds with oriented coboundary. Orientation is crucial here, since the Hirzebruch signature theorem does not hold for unoriented manifolds. To generalize the Milnor invariant, we look at a higher-order type of orientation known as a spin structure. This will lead us to the Eells-Kupier invariant, first defined in \cite{eellskupier1962}.

Recall that the group $\SO_n$ has fundamental group $\Z/2$ for $n\geq 3$, and so the universal cover of $\SO_n$ is a double cover. This double cover is denoted $\Spin_n$ and are known as \defn{spin groups}. The group structure of $\SO_n$ lifts naturally to any covering space, so we could define the Lie group structure on $\Spin_n$ this way. However, there is a more satisfying definition of $\Spin_n$ in terms of Clifford algebras, so we refer the reader to Chapter 1 of the standard reference for spin geometry \cite{lawson1989spin} for more details on this construction.

In low dimensions, there are some exceptional isomorphisms which help with intuition for the spin groups.
\begin{example}
	$\Spin_3\cong \SU_2\cong \Sp_1$.

	Since $\SO_3\cong \RP^3$, the covering map $\Spin_3 \to \SO^3$, at least topologically, is the map identifying antipodal points on a $3$-sphere $S^3\to \RP^3$.
\end{example}
\begin{example}
	$\Spin_4\cong \Spin_3\times\Spin_3\cong \SU_2\times \SU_2\cong \Sp_1\times \Sp_2$.

	This exceptional isomorphism will be discussed in \cref{sec:milnor-spheres}.
\end{example}

Since we have a map $\Spin_n \to \SO_n$, we can ask if a bundle with structure group $\SO_n$ admits a lift to $\Spin_n$, this might uncover some interesting structure. Spin structure, and its related constructions in physics is a notoriously tricky concept to visualize. Aside from \cite{lawson1989spin}, a good reference providing intuitive explanations of spin structure is \cite{nakahara2003}.

\begin{definition}
	A \defn{spin structure} on an oriented Riemannian vector bundle $\mathcal{E}$ is a lift of the principal $\SO_n$-bundle $\Fr^\SO(\mathcal{E})$ of oriented orthonormal frames to a principal $\Spin_n$-bundle. A spin structure on a Riemannian manifold is a spin structure on its tangent bundle, and when a manifold admits a spin structure we say it is ``spin''.
\end{definition}

\begin{example}
	$\CP^2$ does not admit a spin structure.
\end{example}

\begin{example}
	The K3 surface $K_3$ admits a spin structure.
\end{example}

Just like the first Stiefel-Whitney class $w_1$ obstructs an orientation on a vector bundle, there is a similar obstruction for a spin structure.

\begin{theorem}[Borel-Hirzebruch]
	A spin structure on an oriented Riemannian vector bundle $\mathcal{E}$ exists if and only if the second Stiefel-Whitney class $w_2(\mathcal{E})$ vanishes.
\end{theorem}
\begin{proof}
	This is proved using standard methods in obstruction theory. For details, see Theorem 1.7 of Chapter II in \cite{lawson1989spin}.
\end{proof}

\begin{remark}
	Historically, the motivation for spin structure first arose from physics. In the 1920s, physicists attempted to merge quantum mechanics with Einstein's theory of special relativity. \todo{elaborate a bit}.
	% The first such attempt resulted in the Klein-Gordon wave equation
	% \[
	% 	\left(-\frac{\partial^2}{\partial t^2} + \nabla^2\right)\psi = m^2\psi
	% \]
\end{remark}

As with the Hirzebruch signature theorem for signature, we hope to get an integrality theorem for some invariant which is defined for manifolds with spin structure. 

\begin{definition}
	The \defn{$\Ahat$-genus} of a closed oriented manifold $M$ is the characteristic number $\Ahat[M]$ where $\Ahat$ is the characteristic class coming from the characteristic series
	\[
		Q_{\Ahat}(t) = \frac{t/2}{\sinh(t/2)} = 1 - \frac{1}{24} t^2 + \frac{7}{5760} t^4 - \frac{31}{967680} t^6 + \frac{127}{154828800}t^8+\cdots.
	\]
\end{definition}

\begin{example}
	The first few polynomials in the $\Ahat$ genus are given by:
\[
	\begin{aligned}
		\Ahat_1 &= \frac{1}{24}(-p_1),\\
		\Ahat_2 &= \frac{1}{5760}(-4p_2 + 7p_1^2),\\
		\Ahat_3 &= \frac{1}{967680}(-16p_3+44p_2p_1-31p_1^3),\\
		\Ahat_4 &= \frac{1}{464486400}(-192p_4+512p_3p_1+208p_2^2-904p_2p_1^2+381p_1^4)
	\end{aligned}
\]
\end{example}

\begin{proposition}\label{prop:leading_coefficient_Ahat_genus}
	The leading coefficient of the $\Ahat$-genus $\Ahat_k$ is $\widehat{s}_k=B_{2k}/2(2k)!$.
\end{proposition}
\begin{proof}
	By the same idea as \cref{prop:leading_coefficient_L_genus}, we get a generating function for $\widehat{s}_k$
	\[
		1-t\frac{d\log Q_{\Ahat}(\sqrt{t})}{dt} = 1+\frac{t}{24}-\frac{t^2}{1440}+\frac{t^3}{60480} - \frac{t^4}{2419200}+\cdots = \sum_{k\geq 0} (-1)^{k+1}\widehat{s}_k t^k.
	\]
	This completes the proof.
\end{proof}

\begin{theorem}\label{thm:Ahat-integrality}
	If $M$ is an oriented closed $2m$-dimensional manifold with a spin structure, then $\Ahat[M]$ is an integer. If $m\equiv 2\mod 4$, then $\Ahat[M]$ is an even integer.
\end{theorem}

As an immediate corollary, we have:

\begin{theorem}[Rochlin]\label{thm:rochlin}
	The signature of an oriented closed $4$-manifold is divisible by $16$.
\end{theorem}
\begin{proof}
	If $M$ is a oriented closed $4$-manifold, we have
	\[
		\sigma(M) = \frac{p_1[M]}{3}\quad\textrm{and}\quad p_1[M] = -24\cdot\Ahat[M].
	\]
	If follows that $\sigma(M)=-8\cdot\Ahat[M]$, and by \cref{thm:Ahat-integrality} we know that $\Ahat[M]$ is even. Therefore, the signature is divisible by $8$.
\end{proof}

\begin{remark}\label{rmk:E8-manifold}
	Rochlin's theorem and the $E_8$ matrix imply that there exists a closed orientable topological $4$-manifold with no smooth structure. The basic idea is to construct a closed manifold with intersection form $E_8$ (this is non-trivial, note that plumbing leaves a non-empty boundary). 
	Such a manifold can then not admit a smooth structure since its signature should be divisible by 16. This is one of many consequences of Freedman's classification of topological $4$-manifolds in \cite{freedman1982manifold}.
\end{remark}

After the very brief introduction to the $\Ahat$ genus and its integrality theorem, we can now apply the techniques behind the construction of the Milnor invariant to the $\Ahat$ genus. As before, we begin with the $7$-dimensional case. 

Suppose we had an closed $8$-dimensional manifold $W$. If $W$ is oriented and spin, we have the integer invariants
\[
	\sigma(W) = \frac{1}{45}(7p_2- p_1^2)[W]\quad\textrm{and}\quad\Ahat_2[W] = \frac{1}{5760}(-4p_2 + 7p_1^2)[W].
\]
If we remove the assumption that $W$ is closed, as per the discussion in \cref{sec:milnor-method}, the second Pontryagin number $p_2[M]$ loses topological invariance. We therefore would like to remove the dependence of $\Ahat_2$ on $p_2$. 
\[
\begin{aligned}
	p_2[W] = \frac{45\sigma(W) +p_1^2[W]}{7}\quad\implies\quad 
	\Ahat_2[W] &= \frac{1}{5760}\left(-4\cdot \frac{45\sigma(W) + p_1^2[W]}{7} + 7p_1^2[W]\right)\\
						 &=\frac{1}{896}(p_1^2[W]-4\sigma(W)).
\end{aligned}
\]
This is an integer for closed manifolds $W$ with spin structure, so taking the fractional part, we get a homotopy sphere invariant when $W$ has boundary.

\begin{definition}\label{def:eells-kupier-7-dimension}
	Let $M$ be a closed oriented $7$-manifold with $\H^3(M;\Q)$ and $\H^4(M;\Q)$ trivial, and let $W$ be a coboundary with spin structure. The \defn{Eells-Kupier invariant} of $M$ is
	\[
		\ekinv(M) = p_1^2[W, M]-4\sigma(W)\mod 896
	\]
	for any coboundary $W$ with spin structure.
\end{definition}

More generally, suppose we had a closed $(4k-1)$-manifold with $\H^{2i}(M;\Q)$ and $\H^{4i}(M;\Q)$ trivial. If $W$ is a coboundary admitting a spin structure, we can express its $\Ahat$-genus as
\[
	\begin{aligned}
	\Ahat[W]&=\Ahat_k(p_1,\ldots, p_k)[W]\\
					&= \Ahat_k\left(p_1, \ldots, p_{k-1}, \frac{\sigma(W)-L_k(p_1,\ldots, p_{k-1},0)}{s_k}\right)[W]
	\end{aligned}
\]
By \cref{thm:Ahat-integrality}, we get an extra divisibility by a factor of $2$ when $k\equiv 1\mod 2$. We denote this factor 
\[
	\varepsilon(k) = 
	\begin{cases}
		1 & k\equiv 0 \mod 2,\\
		2 & k\equiv 1 \mod 2.\\
	\end{cases}
\] 

\begin{definition}
	Let $M$ be a closed oriented $(4k-1)$-manifold with $\H^{2i}(M;\Q)$ and $\H^{4i}(M;\Q)$ trivial for all $i<k$, and let $W$ be a spin coboundary. The \defn{Eells-Kupier invariant} of $M$ is
	\[
		\ekinv(M) = \frac{1}{\varepsilon(k)}\cdot \Ahat_k\left(p_1, \ldots, p_{k-1}, \frac{\sigma(W)-L_k(p_1,\ldots, p_{k-1},0)}{s_k}\right)[W,M]\mod 1.
	\]
	We leave this expression $\mod 1$ to keep it sightly.
\end{definition}

\begin{example}
	The first few Eells-Kupier invariants are:
	\[
		\renewcommand{\arraystretch}{1.2}
		\begin{array}{r@{\;}ll}
			\ekinv(M^7)
			 & = 4\sigma(W) - p_1^2[W, M]
			 & \mod 896,                                                        \\
			\ekinv(M^{11})
			 & = 24\sigma + (3p_1^3-4p_1p_2)[W,M]
			 & \mod 190464,                                                       \\
			\ekinv(M^{15})
			 & = 2880\sigma(W) - (153p_1^4-360p_1^2p_2+80p_2^2+192p_1p_3)[W,M]
			 & \mod 187269120.
		\end{array}
	\]
\end{example}

\subsection{A ``Twisted'' Eells-Kupier Invariant}

The final example of an exotic sphere invariant constructed out of an integrality theorem is based on the twisted $\Ahat$-genus. We refer to this as the ``twisted'' Eells-Kupier invariant, and to the best of my knowledge it does not appear anywhere in the existing literature.

The origin of the term ``twisted'' in this context is with the addition of a complex vector bundle to the ordinary $\Ahat$-genus. Namely, for an even-dimensional spin manifold with complex vector bundle $E$, we define $\Ahat(M, E) = \textrm{ch}(E)\smile \Ahat(M)$ where $\textrm{ch}$ is the Chern character 
\[
		\textrm{ch}(E) = \exp(\gamma_1(E))+\cdots +\exp(\gamma_n(E))
\]
for $\gamma_i$ the Chern roots. This has an alternate definition as the index of the twisted Dirac operator, see \todo{cite} for more details.

For us, the relevant expression is found on page 98 of \cite{hopkinsmahowald2002bo8}:
\begin{proposition}
	For a $24$-dimensional real manifold $M$, we have
	\[
		\Ahat(M,\T M_\C) = \frac{1}{158505984000}\left(-25167p_2^3 - 18832p_3^2 + 38828p_2p_4 - 4976p_6\right)(M)
	\]
\end{proposition}

Just as a spin structure restricts the $\Ahat$-genus to be integral up to a factor of $2$, a generalization known as a \defn{string structure} gives a similar integrability condition to the twisted $\Ahat$-genus. In the simplest possible terms, a string structure is a lift of a spin structure to the next stage of the Whitehead tower $\Spin_n \to \SO_n \to \O_n$. The classical motivation for defining such a structure can be found in \cite{witten1988string}.

By a homotopy theoretic argument involving the Witten genus and the $\mathrm{tmf}$ spectrum of topological modular forms, Mahowald and Hopkins proved the following integrality theorem:
\begin{theorem}[Mahowald-Hopkins]
	A closed string manifold $M$ has $24\mid \Ahat(M,T)$.
\end{theorem}

By the same construction as the Eells-Kupier invariant, we derive the following invariant:

\begin{corollary}
	Let $M$ be a closed $23$-manifold with $\H^{4i}(M)$ and $\H^{2i}(M)$ trivial. For any string coboundary $W$, the \defn{twisted Eells-Kupier invariant} is given by
	\[
		\lambda_{\mathrm{m,h}}(M) = 153945\sigma(W) + 2591p_2^3[W,M]\mod 521432801280.
	\]
\end{corollary}

Of course, this invariant proves nothing new about exotic spheres, since far simpler methods can be used to compute the order of $\Theta^{23}$. Nevertheless, it is interesting to note that this construction provides an invariant which works for not just homotopy $23$-spheres, and can detect more of the exotic spheres in $23$-dimensions than the Eells-Kupier and Milnor invariants can alone.

\subsection{Lower Bounds on \texorpdfstring{$|\bP^{4k}|$}{|bP^4k|}}\label{sec:lower-bounds}

In this section, we use obtain lower bounds on the order of $\bP^{4k}$. In the grand scheme of things, these results are not terribly useful for the classification of exotic spheres, since standard arguments in obstruction theory can compute $|\bP^{4k}|$ directly. In fact, it turns out that the signature of a coboundary of a sphere in $\bP^{4k}$ is enough to determine it completely. However, the invariants constructed in the previous section work for a larger class of smooth manifolds than just homotopy spheres, let alone homotopy spheres in $\bP^{4k}$. 

The benchmark for our lower bounds is the following exact formula:

\begin{theorem}[Milnor-Kervaire]\label{thm:kervaire-milnor}
	For every $k>1$, $bP^{4k}$ is a cyclic group of order
	\[
		|\bP^{4k}| =2^{2k-2}(2^{2k-1}-1)\epsilon(k)\denom(B_{2k}/4k).
	\]
	Recall here that $\epsilon(k)$ is $2$ when $k$ is odd and $1$ when $k$ is even.
\end{theorem}
\begin{proof}
	See Lemma 3.5 of \cite{milnor1958manifolds} or Corollary 3.20 of \cite{levine1985lectures} for a summary.
\end{proof}

\begin{remark}
	The presence of the factor $\denom(B_{2k}/4k)$ here is the order of cokernel of the $J$-homomorphism $\pi_{4k-1}(\SO) \to \pi_{4k-1}(S)$ in stable homotopy theory. This homomorphism naturally arises in the study of homotopy spheres through obstruction theory, for more information see \cite{milnorkervaire1960bernoulli}.
\end{remark}

Now let us apply our invariants to find lower bounds on $|\bP^{4k}|$. If $M\in \bP^{4k}$ with framed coboundary $W$, note that all invariants constructed above come in the form
\[
		\lambda(M) = A\cdot \sigma(W) \mod B
\]
since all of the Pontryagin classes of a framed manifold vanish (recall that Pontryagin classes are stable). Here, $A$ and $B$ have no common factors. Since signature is additive under connected, this gives us a group homomorphism
\[
	\lkxfunc{\lambda}{\bP^{4k}}{\Z/B.}
\]
The image of the cyclic group generated by $M$ under this map then has image of size $B/\sigma(W)$. By Lagrange's theorem, this must divide the order of $\bP^{4k}$. At this point, we must peek ahead to \cref{chap:constructions} to actually get a homotopy sphere. The relevant result is:

\begin{proposition}
	For every $k>1$, there exists a homotopy sphere $M\in \bP^{4k}$ which has a highly-connected and framed coboundary of signature 8. In particular, it satisfies the conditions of the Milnor, Eells-Kupier, and twisted Eells-Kupier invariants.
\end{proposition}
\begin{proof}
	See \cref{sec:plumbing}.
\end{proof}

In the case of the Milnor invariant, we can write
\[
	\milinv(M) = \frac{1}{s_k}\cdot \sigma(W)\mod 1\quad\implies\quad \milinv(M) = \denom(s_k)\cdot \sigma(W)\mod \numer(s_k).
\]
This gives us the lower bound:

\begin{proposition}\label{prop:milnor-lower-bound}
	For $k>1$, the order $|\bP^{4k}|$ is divisible by
	\[
		\mathrm{LB}_{\mathrm{mil}}(k) =\numer\left(\frac{s_k}{8}\right) = \numer\left(\frac{2^{2k-3}(2^{2k-1}-1)B_{2k}}{(2k)!}\right)
	\]
\end{proposition}

For the Eells-Kupier invariant, we can write
\[
	\ekinv(M) = \frac{\widehat{s}_k}{\epsilon(k)}\cdot \frac{\sigma(W)}{s_k} \mod 1
\]
Recall that $\widehat{s}_k$ is the leading coefficient of the $\Ahat$-genus $\Ahat_k$, and $\epsilon(k)$ is $2$ when $k$ is odd and $1$ otherwise. Expanding out this fraction, we get
\[
	\frac{\widehat{s}_k}{\epsilon(k)s_k} = \frac{B_{2k}/2(2k)!}{2^{2k}(2^{2k-1}-1)B_{2k}/(2k)!} = \frac{1}{\epsilon(k) 2^{2k+1}(2^{2k-1}-1)}.
\]
This gives us the lower bound:
\begin{proposition}\label{prop:eells-kupier-lower-bound}
	For $k>1$, the order of $\bP^{4k}$ is divisible by
	\[
		\mathrm{LB}_{\mathrm{e,k}}(k)=\denom\left(\frac{\widehat{s}_k}{8\epsilon(k)s_k}\right) = 2^{2k-2}(2^{2k-1}-1)\epsilon(k).
	\]
\end{proposition}
This is a rather curious lower bound, since it cleanly divides the Milnor-Kervaire formula for the order of $\bP^{4k}$, leaving behind a factor of $\numer(B_{2k}/4k)$ which the order of the cokernel of the stable $J$-homomorphism.

We can combine the Eells-Kupier and Milnor lower bounds with the LCM to get an improved bound:

\begin{proposition}\label{prop:lcm-lower-bound}
	For $k>1$, the order of $\bP^{4k}$ is divisible by \[\mathrm{LB}_{\mathrm{lcm}}(k)=\lcm(\mathrm{LB}_{\mathrm{mil}}(k),\mathrm{LB}_{\mathrm{e,k}}(k)).\]
\end{proposition}

The twisted Eells-Kupier invariant is defined only in the case $k=6$, and gives us:
\begin{proposition}\label{prop:twisted-eells-kupier-lower-bound}
	The order of $\bP^{24}$ is divisible by
	\[
		\mathrm{LB}_{\mathrm{m,h}}(6) = \numer\left(\frac{521432801280}{8\cdot 153945}\right) = 1448424448.
	\]
\end{proposition}

Let us now investigate how these invariants compare in effectiveness. Plotting the first few values of $k$, we get: 

\begin{figure}[ht]
	\centering
\begin{tikzpicture}
\begin{axis}[
		width=0.8\textwidth,
		height=3in,
    xlabel={$4k-1$},
    xtick=data,
    ymode=log,
    legend pos=north west]

\addplot[thick, gray] table[x index=0, y index=1] {chapters/invariants/lowdim.dat};
\addplot[thick, violet, mark=square] table[x index=0, y index=2] {chapters/invariants/lowdim.dat};
\addplot[thick, blue, mark=square] table[x index=0, y index=3] {chapters/invariants/lowdim.dat};

\addplot[thick, black, mark=*] coordinates {(23,1448424448)};

\legend{$|\bP^{4k}|$,$\mathrm{LB}_{\mathrm{mil}}(k)$,$\mathrm{LB}_{\mathrm{e,k}}(k)$, $\mathrm{LB}_{\mathrm{m,h}}(6)$}

\end{axis}
\end{tikzpicture}
\caption{Lower bounds on $|\bP^{4k}|$ in low dimensions.}
\end{figure}

Up to $k=5$, the Eells-Kupier invariant is a perfect invariant for $\bP^{4k}$, however this breaks down at $k=6$. This failure corresponds to the non-trivial cokernel of the $J$-homomorphism in dimension $23$:
\[
	\begin{tabular}{c|c|c|c|c|c|c|c|c}
		k & $\leq$ 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12\\
		\hline
		$\numer(B_{2k}/4k)$ & 1 & 691 & 1 & 3617 & 43867 & 174611 & 77683 & 236364091\\
	\end{tabular}
\]
Consequently, the only dimensions in which the Eells-Kupier invariant is able to detect all homotopy spheres in $\bP^{4k}$ are $7,11,15,19,$ and $27$. However, in the $23$-dimensional case, the twisted Eells-Kupier invariant successfully computes the order of $\bP^{24}$. 
While in low dimensions the Eells-Kupier invariant is better than the Milnor invariant at detecting homotopy spheres, in dimensions $\geq 43$ the Milnor lower bound quickly outgrows the Eells-Kupier bound as the Bernoulli numerators become non-trivial (see \cref{fig:high-dim-lower-bound}). The LCM bound is surprisingly good, and is able to correctly compute the size of $\bP^{4k}$ up to dimension 131 (see \cref{fig:lcm-lower-bound}).

\begin{figure}[ht]
	\centering
	\begin{tikzpicture}
\begin{axis}[
    xlabel={$4k-1$},
		width=0.8\textwidth,
		xmin=-10,
		height=3in,
		yticklabel={\ensuremath{10^{\pgfmathprintnumber[fixed,precision=0]{\tick}}}},
    legend pos=north west
]

\addplot[thick, gray] table[x index=0, y index=1] {chapters/invariants/highdim.dat};
\addplot[thick, violet] table[x index=0, y index=2] {chapters/invariants/highdim.dat};
\addplot[thick, blue] table[x index=0, y index=3] {chapters/invariants/highdim.dat};

\legend{$|\bP^{4k}|$,$\mathrm{LB}_{\mathrm{mil}}(k)$,$\mathrm{LB}_{\mathrm{e,k}}(k)$}

\end{axis}
\end{tikzpicture}
\caption{Lower bounds on $|\bP^{4k}|$ in higher dimensions.}\label{fig:high-dim-lower-bound}
\end{figure}

\begin{figure}[ht]
	\centering
	\begin{tikzpicture}
\begin{axis}[
    xlabel={$4k-1$},
		width=0.8\textwidth,
		xmin=-10,
		height=3in,
		ymode=log,
		% yticklabel={\ensuremath{10^{\pgfmathprintnumber[fixed,precision=0]{\tick}}}},
    legend pos=north west
]

\addplot[thick, black, mark=square, ycomb, mark size=0.5] table[x index=0, y index=1] {chapters/invariants/ratio.dat};

\legend{$|\bP^{4k}|/\mathrm{LB}_{\mathrm{lcm}}(k)$}

\end{axis}
\end{tikzpicture}
\caption{The LCM lower bound.}\label{fig:lcm-lower-bound}
\end{figure}

% This is a very good lower bound, in fact it correctly computes the order of $|\bP^{4k}|$ up to $k
%
% \todo{This is one of }
%
% % In this section, we 
%
% \begin{proposition}
% 	The leading coefficient of 
% \end{proposition}
% Note that the leading coefficient of the $\Ahat$ genus is 
% % This is the Eells-Kupier invariant
%
% At this point, we assume the existence of a construction of a homotopy sphere from the next chapter. This allows us to investigate some lower bounds on the size of $\bP^{4k}$ using the Milnor, Eells-Kupier, and twisted Eells-Kupier invariant.
%
% \begin{proposition}
% 	There exists a homotopy sphere $M\in \bP^{4k}$ bounding a highly-connected manifold of signature $8$.
% \end{proposition}
% \begin{proof}
% 	See \cref{sec:plumbing}.
% \end{proof}
%
%
% \begin{center}
% 	\begin{tikzpicture}
% \begin{axis}[
%     xlabel={$k$},
%     yticklabel={\ensuremath{10^{\tick}}},
%     legend pos=north west
% ]
%
% \addplot[thick, black] table[x index=0, y index=1] {chapters/invariants/highdim.dat};
% \addplot[thick, blue] table[x index=0, y index=2] {chapters/invariants/highdim.dat};
% \addplot[thick, red] table[x index=0, y index=3] {chapters/invariants/highdim.dat};
%
% \legend{$\log_{10}|bP^{4k}|$,$\milinv$,$\ekinv$}
%
% \end{axis}
% \end{tikzpicture}
% \end{center}
